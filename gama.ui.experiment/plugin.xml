<?xml version="1.0" encoding="UTF-8"?>
<?eclipse version="3.4"?>
<plugin>


   <extension
         point="org.eclipse.ui.perspectives">
      <perspective
            class="gama.ui.experiment.perspective.SimulationPerspective"
            fixed="false"
            icon="platform:/plugin/gama.ui.base/icons/perspective.simulation2.png"
            id="gama.perspective.simulation"
            name="Simulation">
         <description>
            The base perspective definition for simulation perspectives
         </description>
      </perspective>
   </extension>
   <extension
         point="org.eclipse.ui.perspectiveExtensions">
      <perspectiveExtension
            targetID="gama.perspective.simulation">
         <viewShortcut
               id="gama.view.ConsoleView">
         </viewShortcut>
         <viewShortcut
               id="gama.view.ErrorView">
         </viewShortcut>
         <viewShortcut
               id="gama.view.ParameterView">
         </viewShortcut>
      </perspectiveExtension>
   </extension>
   <extension
         point="org.eclipse.ui.views">
      <view
            allowMultiple="false"
            category="gama.category"
            class="gama.ui.experiment.views.console.ConsoleView"
            icon="platform:/plugin/gama.ui.base/icons/view.console2.png"
            id="gama.view.ConsoleView"
            name="Console"
            restorable="false">
      </view>
      <view
            allowMultiple="true"
            category="gama.category"
            class="gama.ui.experiment.views.inspectors.PopulationInspectView"
            icon="platform:/plugin/gama.ui.base/icons/view.browser2.png"
            id="gama.view.TableAgentInspectView"
            name="Browser"
            restorable="false">
      </view>
      <view
            allowMultiple="true"
            category="gama.category"
            class="gama.ui.experiment.views.inspectors.AgentInspectView"
            icon="platform:/plugin/gama.ui.base/icons/view.inspector2.png"
            id="gama.view.AgentInspectView"
            name="Inspector"
            restorable="false">
      </view>
      <view
            allowMultiple="false"
            category="gama.category"
            class="gama.ui.experiment.views.inspectors.MonitorView"
            icon="platform:/plugin/gama.ui.base/icons/view.monitors2.png"
            id="gama.view.MonitorView"
            name="Monitors"
            restorable="false">
      </view>
      <view
            allowMultiple="false"
            category="gama.category"
            class="gama.ui.experiment.views.inspectors.ExperimentParametersView"
            icon="platform:/plugin/gama.ui.base/icons/view.parameters2.png"
            id="gama.view.ParameterView"
            name="Parameters"
            restorable="false">
      </view>
      <view
            allowMultiple="false"
            category="gama.category"
            class="gama.ui.experiment.views.ErrorView"
            icon="platform:/plugin/gama.ui.base/icons/view.errors2.png"
            id="gama.view.ErrorView"
            name="Errors"
            restorable="false">
      </view>
      <view
            category="gama.category"
            class="gama.ui.experiment.views.user.UserControlView"
            fastViewWidthRatio="0.2"
            icon="platform:/plugin/gama.ui.base/icons/view.panel2.png"
            id="gama.view.UserControlView"
            name="User Control"
            restorable="false">
      </view>
   </extension>
   <extension
         point="org.eclipse.ui.menus">
      <menuContribution
            locationURI="menu:org.eclipse.ui.main.menu">
         <menu
               id="simulationMenu"
               label="Experiment">
            <visibleWhen
                  checkEnabled="false">
               <reference
                     definitionId="isSimulationReady">
               </reference>
            </visibleWhen>
            <command
                  commandId="gama.command.play.simulation"
                  icon="platform:/plugin/gama.ui.base/icons/menu.run4.png"
                  label="Run Experiment"
                  style="push">
               <visibleWhen
                     checkEnabled="false">
                  <reference
                        definitionId="isSimulationPaused">
                  </reference>
               </visibleWhen>
            </command>
            <command
                  commandId="gama.command.pause.simulation"
                  icon="platform:/plugin/gama.ui.base/icons/menu.pause4.png"
                  label="Pause Experiment"
                  mnemonic="M1+P"
                  style="push">
               <visibleWhen
                     checkEnabled="false">
                  <reference
                        definitionId="isSimulationRunning">
                  </reference>
               </visibleWhen>
            </command>
            <command
                  commandId="gama.command.step.simulation"
                  icon="platform:/plugin/gama.ui.base/icons/menu.step4.png"
                  label="Step Experiment"
                  style="push"
                  tooltip="Advance the experiment step by step">
               <visibleWhen
                     checkEnabled="false">
                  <reference
                        definitionId="isSimulationReady">
                  </reference>
               </visibleWhen>
            </command>
            <command
                  commandId="gama.command.back.simulation"
                  icon="platform:/plugin/gama.ui.base/icons/menu.stepBack1.png"
                  label="Step Back Experiment"
                  style="push"
                  tooltip="Make One step back in the simulation">
               <visibleWhen
                     checkEnabled="false">
                  <and>
                     <reference
                           definitionId="isSimulationReady">
                     </reference>
                     <reference
                           definitionId="isSimulationMemorize">
                     </reference>
                  </and>
               </visibleWhen>
            </command>
            <separator
                  name="gama.sep.1"
                  visible="true">
            </separator>
            <command
                  commandId="gama.command.reload.simulation"
                  icon="platform:/plugin/gama.ui.base/icons/menu.reload4.png"
                  label="Reload Experiment"
                  mnemonic="M1+M2+R"
                  style="push">
            </command>
            <separator
                  name="gama.sep.2"
                  visible="true">
            </separator>
            <command
                  commandId="gama.command.error.pause"
                  icon="platform:/plugin/gama.ui.base/icons/menu.stop2.png"
                  label="Stop at first error"
                  style="toggle">
            </command>
            <command
                  commandId="gama.command.error.warning"
                  icon="platform:/plugin/gama.ui.base/icons/menu.warning2.png"
                  label="Treat warnings like errors"
                  style="toggle">
            </command>
            <command
                  commandId="gama.command.error.show"
                  icon="platform:/plugin/gama.ui.base/icons/menu.show2.png"
                  label="Display errors and warnings"
                  style="toggle">
            </command>
            <separator
                  name="gama.sep.5"
                  visible="true">
            </separator>
            <command
                  commandId="gama.command.close.simulation"
                  icon="platform:/plugin/gama.ui.base/icons/toolbar.stop2.png"
                  label="Close Experiment"
                  style="push"
                  tooltip="Stops the current experiment and dispose of it.">
               <visibleWhen
                     checkEnabled="false">
                  <and>
                     <reference
                           definitionId="isInSimulationPerspective">
                     </reference>
                     <reference
                           definitionId="isSimulationExisting">
                     </reference>
                  </and>
               </visibleWhen>
            </command>
         </menu>
         <menu
               label="Agents">
            <dynamic
                  class="gama.ui.experiment.menus.AgentsMenu"
                  id="gama.menu.agents">
            </dynamic>
            <visibleWhen
                  checkEnabled="false">
               <reference
                     definitionId="isSimulationReady">
               </reference>
            </visibleWhen>
         </menu>
         <menu
               id="viewMenu"
               label="Views">
            <command
                  commandId="gama.command.interactive.console"
                  icon="platform:/plugin/gama.ui.base/icons/view.interactive.png"
                  label="Interactive Console"
                  style="push">
            </command>
            <command
                  commandId="org.eclipse.ui.window.hideShowEditors"
                  icon="platform:/plugin/gama.ui.base/icons/menu.save.perspective.png"
                  label="Hide/Show Editors"
                  style="push"
                  tooltip="Hide or show the editors">
            </command>
            <separator
                  name="gama.sep.3"
                  visible="true">
            </separator>
            <command
                  commandId="gama.command.toggle.parameters"
                  icon="platform:/plugin/gama.ui.base/icons/menu.open.parameters2.png"
                  label="Parameters"
                  style="push">
               <visibleWhen
                     checkEnabled="false">
                  <reference
                        definitionId="isSimulationReady">
                  </reference>
               </visibleWhen>
            </command>
            <command
                  commandId="gama.command.toggle.console"
                  icon="platform:/plugin/gama.ui.base/icons/menu.open.console2.png"
                  label="Console"
                  style="push">
               <visibleWhen
                     checkEnabled="false">
                  <reference
                        definitionId="isSimulationReady">
                  </reference>
               </visibleWhen>
            </command>
            <command
                  commandId="gama.command.add.monitor"
                  icon="platform:/plugin/gama.ui.base/icons/menu.monitor2.png"
                  label="Add Monitor"
                  style="push">
               <visibleWhen
                     checkEnabled="false">
                  <reference
                        definitionId="isSimulationReady">
                  </reference>
               </visibleWhen>
            </command>
            <separator
                  name="gama.sep.10"
                  visible="true">
            </separator>
            <menu
                  icon="platform:/plugin/gama.ui.base/icons/layout.stack.png"
                  label="Manage outputs...">
               <visibleWhen
                     checkEnabled="false">
                  <reference
                        definitionId="isSimulationReady">
                  </reference>
               </visibleWhen>
               <dynamic
                     class="gama.ui.experiment.menus.OutputsMenu"
                     id="gama.menu.outputs">
               </dynamic>
            </menu>
            <menu
                  icon="platform:/plugin/gama.ui.base/icons/menu.layout.png"
                  label="Layout Displays... (Experimental)">
               <command
                     commandId="gama.command.layout.displays"
                     icon="platform:/plugin/gama.ui.base/icons/layout.stack.png"
                     label="Stacked"
                     style="push">
                  <parameter
                        name="gama.displays.layout"
                        value="Stacked">
                  </parameter>
               </command>
               <command
                     commandId="gama.command.layout.displays"
                     icon="platform:/plugin/gama.ui.base/icons/layout.grid.png"
                     label="Split"
                     style="push">
                  <parameter
                        name="gama.displays.layout"
                        value="Split">
                  </parameter>
               </command>
               <command
                     commandId="gama.command.layout.displays"
                     icon="platform:/plugin/gama.ui.base/icons/layout.horizontal.png"
                     label="Horizontally"
                     style="push">
                  <parameter
                        name="gama.displays.layout"
                        value="Horizontal">
                  </parameter>
               </command>
               <command
                     commandId="gama.command.layout.displays"
                     icon="platform:/plugin/gama.ui.base/icons/layout.vertical.png"
                     label="Vertically"
                     style="push">
                  <parameter
                        name="gama.displays.layout"
                        value="Vertical">
                  </parameter>
               </command>
               <visibleWhen
                     checkEnabled="false">
                  <and>
                     <reference
                           definitionId="isSimulationReady">
                     </reference>
                     <reference
                           definitionId="isInSimulationPerspective">
                     </reference>
                  </and>
               </visibleWhen>
               <separator
                     name="gama.sep.4"
                     visible="true">
               </separator>
               <command
                     commandId="gama.command.toggle.display.tabs"
                     label="Toggle Tabs"
                     style="push">
               </command>
               <command
                     commandId="gama.command.copy.layout"
                     label="Copy Layout to Clipboard"
                     style="push">
               </command>
            </menu>
            <menu
                  icon="platform:/plugin/gama.ui.base/icons/menu.other.png"
                  label="Other...">
               <menu
                     icon="platform:/plugin/gama.ui.base/icons/menu.open.perspective2.png"
                     label="Switch to Perspective...">
                  <command
                        commandId="gama.command.goto.modeling"
                        icon="platform:/plugin/gama.ui.base/icons/perspective.modeling2.png"
                        label="Modeling"
                        style="push"
                        tooltip="Open modeling perspective">
                     <visibleWhen
                           checkEnabled="false">
                        <not>
                           <reference
                                 definitionId="isInModelingPerspective">
                           </reference>
                        </not>
                     </visibleWhen>
                  </command>
                  <command
                        commandId="gama.command.goto.simulation"
                        icon="platform:/plugin/gama.ui.base/icons/perspective.simulation2.png"
                        label="Simulation"
                        style="push"
                        tooltip="Open simulation perspective">
                     <visibleWhen
                           checkEnabled="false">
                        <not>
                           <reference
                                 definitionId="isInSimulationPerspective">
                           </reference>
                        </not>
                     </visibleWhen>
                  </command>
               </menu>
               <command
                     commandId="gama.command.reset.perspective"
                     icon="platform:/plugin/gama.ui.base/icons/menu.reset.perspective2.png"
                     label="Reset Perspective (restart required)..."
                     style="push">
                  <visibleWhen
                        checkEnabled="false">
                     <reference
                           definitionId="isInModelingPerspective">
                     </reference>
                  </visibleWhen>
               </command>
               <separator
                     name="gama.sep.1"
                     visible="true">
               </separator>
               <menu
                     icon="platform:/plugin/gama.ui.base/icons/menu.open.view2.png"
                     label="Show View">
                  <dynamic
                        class="gama.ui.base.commands.ShowViewContributionItem"
                        id="gama.command.show.view">
                  </dynamic>
               </menu>
               <command
                     commandId="org.eclipse.ui.ToggleCoolbarAction"
                     icon="platform:/plugin/gama.ui.base/icons/menu.toolbar2.png"
                     label="Toggle Toolbar"
                     style="push"
                     tooltip="Toggle the main toolbar on and off">
               </command>
            </menu>
         </menu>
      </menuContribution>
      <menuContribution
            locationURI="toolbar:gama.toolbar?after=gama.command.goto.modeling">
            <command
                  commandId="gama.command.goto.simulation"
                  icon="platform:/plugin/gama.ui.base/icons/perspective.simulation2.png"
                  label="Simulation perspective"
                  style="push"
                  tooltip="Open simulation perspective">
               <visibleWhen
                     checkEnabled="false">
                  <and>
                     <reference
                           definitionId="isInModelingPerspective">
                     </reference>
                  </and>
               </visibleWhen>
            </command>
            <command
                  commandId="gama.command.dummy"
                  icon="platform:/plugin/gama.ui.base/icons/windows_spacer.png"
                  style="push"
                  tooltip="  ">
            </command>
            <control
                  class="gama.ui.experiment.controls.StatusControlContribution"
                  id="gama.status">
            </control>
            <command
                  commandId="gama.command.dummy"
                  icon="platform:/plugin/gama.ui.base/icons/windows_spacer.png"
                  style="push"
                  tooltip="  ">
            </command>
            <command
                  commandId="gama.command.play.simulation"
                  icon="platform:/plugin/gama.ui.base/icons/menu.run4.png"
                  label="Run Experiment"
                  style="push"
                  tooltip="Run the currently opened experiment">
               <visibleWhen
                     checkEnabled="false">
                  <reference
                        definitionId="isSimulationPaused">
                  </reference>
               </visibleWhen>
            </command>
            <command
                  commandId="gama.command.pause.simulation"
                  icon="platform:/plugin/gama.ui.base/icons/menu.pause4.png"
                  label="Pause Experiment"
                  style="push"
                  tooltip="Pause the currently opened experiment">
               <visibleWhen
                     checkEnabled="false">
                  <reference
                        definitionId="isSimulationRunning">
                  </reference>
               </visibleWhen>
            </command>
            <command
                  commandId="gama.command.step.simulation"
                  icon="platform:/plugin/gama.ui.base/icons/menu.step4.png"
                  label="Step Experiment"
                  style="push"
                  tooltip="Advance the experiment step by step">
               <visibleWhen
                     checkEnabled="false">
                  <reference
                        definitionId="isSimulationReady">
                  </reference>
               </visibleWhen>
            </command>
            <command
                  commandId="gama.command.back.simulation"
                  icon="platform:/plugin/gama.ui.base/icons/menu.stepBack1.png"
                  label="Step Back"
                  style="push"
                  tooltip="Make One step back in the simulation">
               <visibleWhen
                     checkEnabled="false">
                  <and>
                     <reference
                           definitionId="isSimulationReady">
                     </reference>
                     <reference
                           definitionId="isSimulationMemorize">
                     </reference>
                  </and>
               </visibleWhen>
            </command>
            <control
                  class="gama.ui.experiment.controls.SimulationSpeedContributionItem"
                  id="gama.speed">
               <visibleWhen
                     checkEnabled="false">
                  <reference
                        definitionId="isSimulationReady">
                  </reference>
               </visibleWhen>
            </control>
            <command
                  commandId="gama.command.reload.simulation"
                  icon="platform:/plugin/gama.ui.base/icons/menu.reload4.png"
                  label="Reload Experiment"
                  mnemonic="M1+M2+R"
                  style="push">
               <visibleWhen
                     checkEnabled="false">
                  <and>
                     <reference
                           definitionId="isInSimulationPerspective">
                     </reference>
                     <reference
                           definitionId="isSimulationExisting">
                     </reference>
                  </and>
               </visibleWhen>
            </command>
            <command
                  commandId="gama.command.close.simulation"
                  icon="platform:/plugin/gama.ui.base/icons/toolbar.stop2.png"
                  label="Close Experiment"
                  style="push"
                  tooltip="Stops the currently opened experiment and closes its perspective">
               <visibleWhen
                     checkEnabled="false">
                  <and>
                     <reference
                           definitionId="isInSimulationPerspective">
                     </reference>
                     <reference
                           definitionId="isSimulationExisting">
                     </reference>
                  </and>
               </visibleWhen>
            </command>
            <control
                  class="gama.ui.base.controls.Separator"
                  id="gama.sep.2">
            </control>
      </menuContribution>
   </extension>
   <extension
         point="org.eclipse.ui.handlers">
      <handler
            class="gama.ui.experiment.commands.StepBackHandler"
            commandId="gama.command.back.simulation">
         <activeWhen>
            <with
                  variable="gama.ui.experiment.SimulationStepBack">
               <equals
                     value="CAN_STEP_BACK">
               </equals>
            </with>
         </activeWhen>
         <enabledWhen>
            <with
                  variable="gama.ui.experiment.SimulationStepBack">
               <equals
                     value="CAN_STEP_BACK">
               </equals>
            </with>
         </enabledWhen>
      </handler>
      <handler
            class="gama.ui.experiment.commands.PlayPauseSimulationHandler"
            commandId="gama.command.play.simulation">
         <activeWhen>
            <reference
                  definitionId="isSimulationReady">
            </reference>
         </activeWhen>
         <enabledWhen>
            <reference
                  definitionId="isSimulationReady">
            </reference>
         </enabledWhen>
      </handler>
      <handler
            class="gama.ui.experiment.commands.StepByStepHandler"
            commandId="gama.command.step.simulation">
         <activeWhen>
            <and>
               <reference
                     definitionId="isSimulationReady">
               </reference>
               <not>
                  <reference
                        definitionId="isSimulationBatch">
                  </reference>
               </not>
            </and>
         </activeWhen>
         <enabledWhen>
            <and>
               <reference
                     definitionId="isSimulationReady">
               </reference>
               <not>
                  <reference
                        definitionId="isSimulationRunning">
                  </reference>
               </not>
            </and>
         </enabledWhen>
      </handler>
      <handler
            class="gama.ui.experiment.commands.ReloadSimulationHandler"
            commandId="gama.command.reload.simulation">
         <activeWhen>
            <reference
                  definitionId="isSimulationReady">
            </reference>
         </activeWhen>
      </handler>
      <handler
            class="gama.ui.experiment.commands.AddMonitorHandler"
            commandId="gama.command.add.monitor">
         <activeWhen>
            <reference
                  definitionId="isSimulationReady">
            </reference>
         </activeWhen>
      </handler>
      <handler
            class="gama.ui.experiment.commands.ShowHideParametersViewHandler"
            commandId="gama.command.toggle.parameters">
         <activeWhen>
            <reference
                  definitionId="isSimulationReady">
            </reference>
         </activeWhen>
      </handler>
      <handler
            class="gama.ui.experiment.commands.ShowHideConsoleViewHandler"
            commandId="gama.command.toggle.console">
         <activeWhen>
            <reference
                  definitionId="isSimulationReady">
            </reference>
         </activeWhen>
      </handler>
      <handler
            class="gama.ui.experiment.commands.CancelRun"
            commandId="gama.command.close.simulation">
         <activeWhen>
            <reference
                  definitionId="isInSimulationPerspective">
            </reference>
         </activeWhen>
      </handler>
      <handler
            class="gama.ui.experiment.commands.ErrorsPauseAndEdit"
            commandId="gama.command.error.pause">
      </handler>
      <handler
            class="gama.ui.experiment.commands.TreatWarningsAsErrors"
            commandId="gama.command.error.warning">
      </handler>
      <handler
            class="gama.ui.experiment.commands.ShowErrors"
            commandId="gama.command.error.show">
      </handler>
      <handler
            class="gama.ui.base.commands.SwitchToModeling"
            commandId="gama.command.goto.modeling">
         <activeWhen>
            <or>
               <reference
                     definitionId="isSimulationReady">
               </reference>
               <reference
                     definitionId="isSimulationFinished">
               </reference>
            </or>
         </activeWhen>
      </handler>
      <handler
            class="gama.ui.experiment.commands.ToggleDisplayTabs"
            commandId="gama.command.toggle.display.tabs">
         <activeWhen>
            <and>
               <reference
                     definitionId="isInSimulationPerspective">
               </reference>
               <reference
                     definitionId="isSimulationReady">
               </reference>
            </and>
         </activeWhen>
      </handler>
      <handler
            class="gama.ui.experiment.commands.ArrangeDisplayViews"
            commandId="gama.command.layout.displays">
         <activeWhen>
            <and>
               <reference
                     definitionId="isInSimulationPerspective">
               </reference>
               <reference
                     definitionId="isSimulationReady">
               </reference>
            </and>
         </activeWhen>
      </handler>
      <handler
            class="gama.ui.base.commands.SwitchToSimulation"
            commandId="gama.command.goto.simulation">
         <activeWhen>
            <and>
               <reference
                     definitionId="isInModelingPerspective">
               </reference>
               <not>
                  <with
                        variable="gama.ui.experiment.SimulationRunningState">
                     <equals
                           value="NONE">
                     </equals>
                  </with>
               </not>
            </and>
         </activeWhen>
      </handler>
      <handler
            class="gama.ui.experiment.commands.CopyLayout"
            commandId="gama.command.copy.layout">
         <activeWhen>
            <and>
               <reference
                     definitionId="isInSimulationPerspective">
               </reference>
               <reference
                     definitionId="isSimulationReady">
               </reference>
            </and>
         </activeWhen>
      </handler>
      <handler
            class="gama.ui.experiment.commands.ResetModelingPerspective"
            commandId="gama.command.reset.perspective">
         <activeWhen>
            <reference
                  definitionId="isInModelingPerspective">
            </reference>
         </activeWhen>
         <enabledWhen>
            <reference
                  definitionId="isInModelingPerspective">
            </reference>
         </enabledWhen>
      </handler>
   </extension>
   <extension
         point="org.eclipse.ui.contexts">
      <context
            id="gama.context.experiment"
            name="In Experiments"
            parentId="org.eclipse.ui.contexts.dialogAndWindow">
      </context>
   </extension>
   <extension
         point="org.eclipse.core.expressions.definitions">
      <definition
            id="isSimulationReady">
         <and>
            <reference
                  definitionId="isInSimulationPerspective">
            </reference>
            <or>
               <with
                     variable="gama.ui.experiment.SimulationRunningState">
                  <equals
                        value="RUNNING">
                  </equals>
               </with>
               <with
                     variable="gama.ui.experiment.SimulationRunningState">
                  <equals
                        value="STOPPED">
                  </equals>
               </with>
            </or>
         </and>
      </definition>
      <definition
            id="isSimulationRunning">
         <and>
            <reference
                  definitionId="isInSimulationPerspective">
            </reference>
            <with
                  variable="gama.ui.experiment.SimulationRunningState">
               <equals
                     value="RUNNING">
               </equals>
            </with>
         </and>
      </definition>
      <definition
            id="isSimulationPaused">
         <and>
            <reference
                  definitionId="isInSimulationPerspective">
            </reference>
            <with
                  variable="gama.ui.experiment.SimulationRunningState">
               <equals
                     value="STOPPED">
               </equals>
            </with>
         </and>
      </definition>
      <definition
            id="isSimulationExisting">
         <and>
            <reference
                  definitionId="isInSimulationPerspective">
            </reference>
            <not>
               <with
                     variable="gama.ui.experiment.SimulationRunningState">
                  <equals
                        value="NONE">
                  </equals>
               </with>
            </not>
         </and>
      </definition>
      <definition
            id="isGamlEditorOpened">
         <and>
            <reference
                  definitionId="isActiveEditorAnInstanceOfXtextEditor">
            </reference>
            <with
                  variable="activeEditor">
               <test
                     forcePluginActivation="true"
                     property="org.eclipse.xtext.ui.editor.XtextEditor.languageName"
                     value="gama.core.lang.Gaml">
               </test>
            </with>
         </and>
      </definition>
      <definition
            id="isSimulationBatch">
         <and>
            <reference
                  definitionId="isInSimulationPerspective">
            </reference>
            <with
                  variable="gama.ui.experiment.SimulationType">
               <equals
                     value="BATCH">
               </equals>
            </with>
         </and>
      </definition>
      <definition
            id="isSimulationMemorize">
         <and>
            <reference
                  definitionId="isInSimulationPerspective">
            </reference>
            <with
                  variable="gama.ui.experiment.SimulationType">
               <equals
                     value="MEMORIZE">
               </equals>
            </with>
         </and>
      </definition>
      <definition
            id="isInModelingPerspective">
         <with
               variable="activeWorkbenchWindow.activePerspective">
            <equals
                  value="gama.perspective.modeling">
            </equals>
         </with>
      </definition>
      <definition
            id="isInSimulationPerspective">
         <with
               variable="activeWorkbenchWindow.activePerspective">
            <test
                  property="gama.ui.containsString"
                  value="Simulation">
            </test>
         </with>
      </definition>
      <definition
            id="isSimulationFinished">
         <and>
            <reference
                  definitionId="isInSimulationPerspective">
            </reference>
            <with
                  variable="gama.ui.experiment.SimulationRunningState">
               <equals
                     value="FINISHED">
               </equals>
            </with>
         </and>
      </definition>
   </extension>
   <extension
         point="org.eclipse.ui.commands">
      <command
            categoryId="gama.category"
            defaultHandler="gama.ui.experiment.commands.PlayPauseSimulationHandler"
            id="gama.command.play.simulation"
            name="Play Experiment">
      </command>
      <command
            categoryId="gama.category"
            defaultHandler="gama.ui.experiment.commands.PlayPauseSimulationHandler"
            id="gama.command.pause.simulation"
            name="Pause Simulation">
      </command>
      <command
            categoryId="gama.category"
            id="gama.command.step.simulation"
            name="Next Step">
      </command>
      <command
            categoryId="gama.category"
            id="gama.command.back.simulation"
            name="Previous Step ">
      </command>
      <command
            categoryId="gama.category"
            defaultHandler="gama.ui.experiment.commands.ReloadSimulationHandler"
            id="gama.command.reload.simulation"
            name="Reload Simulation">
      </command>
      <command
            categoryId="gama.category"
            defaultHandler="gama.ui.experiment.commands.ShowHideParametersViewHandler"
            id="gama.command.toggle.parameters"
            name="Show parameters">
      </command>
      <command
            categoryId="gama.category"
            id="gama.command.add.monitor"
            name="Add a monitor">
      </command>
      <command
            categoryId="gama.category"
            id="gama.command.toggle.console"
            name="Show console">
      </command>
      <command
            categoryId="gama.category"
            id="gama.command.close.simulation"
            name="Cancel">
      </command>
      <command
            categoryId="gama.category"
            id="gama.command.error.pause"
            name="Pause at first error">
      </command>
      <command
            categoryId="gama.category"
            id="gama.command.error.warning"
            name="Treat warnings like errors">
      </command>
      <command
            categoryId="gama.category"
            id="gama.command.error.show"
            name="Display errors and warnings">
      </command>
      <command
            categoryId="gama.category"
            id="gama.command.goto.modeling"
            name="Switch to modeling perspective">
      </command>
      <command
            categoryId="gama.category"
            id="gama.command.layout.displays"
            name="Layout display views">
         <commandParameter
               id="gama.displays.layout"
               name="layout"
               optional="false"
               typeId="gama.type.String">
         </commandParameter>
      </command>
      <command
            categoryId="gama.category"
            id="gama.command.goto.simulation"
            name="Switch to simulation perspective">
      </command>
      <command
            defaultHandler="gama.ui.experiment.commands.DummyHandler"
            id="gama.command.dummy"
            name="Separator">
      </command>
      <command
            defaultHandler="gama.ui.experiment.commands.ShowInteractiveConsole"
            id="gama.command.interactive.console"
            name="Show Interactive Console">
      </command>
      <command
            id="gama.command.toggle.display.tabs"
            name="Toggle Display Tabs">
      </command>
      <command
            id="gama.command.copy.layout"
            name="Copy Layout">
      </command>
      <command
            categoryId="gama.category"
            id="gama.command.reset.perspective"
            name="Reset Perspective...">
      </command>
      <category
            id="gama.category"
            name="GAMA Commands">
      </category>
   </extension>
   <extension
         point="org.eclipse.ui.services">
      <serviceFactory
            factoryClass="gama.ui.experiment.factories.AgentMenuFactory">
         <service
               serviceClass="gama.ui.base.interfaces.IAgentMenuFactory"></service>
      </serviceFactory>
      <serviceFactory
            factoryClass="gama.ui.experiment.factories.UserDialogFactory">
         <service
               serviceClass="gama.ui.base.interfaces.IUserDialogFactory"></service>
      </serviceFactory>
      <sourceProvider
            provider="gama.ui.experiment.commands.SimulationStateProvider">
         <variable
               name="gama.ui.experiment.SimulationRunningState"
               priorityLevel="workbench">
         </variable>
         <variable
               name="gama.ui.experiment.SimulationType"
               priorityLevel="workbench">
         </variable>
      </sourceProvider>
      <serviceFactory
            factoryClass="gama.ui.experiment.factories.SpeedDisplayerFactory">
         <service
               serviceClass="gama.ui.base.interfaces.ISpeedDisplayer">
         </service>
      </serviceFactory>
      <serviceFactory
            factoryClass="gama.ui.experiment.factories.StatusDisplayerFactory">
         <service
               serviceClass="gama.common.ui.IStatusDisplayer">
         </service>
      </serviceFactory>
      <serviceFactory
            factoryClass="gama.ui.experiment.factories.ConsoleDisplayerFactory">
         <service
               serviceClass="gama.common.ui.IConsoleDisplayer">
         </service>
      </serviceFactory>
      <serviceFactory
            factoryClass="gama.ui.experiment.factories.DisplayLayoutFactory">
         <service
               serviceClass="gama.ui.base.interfaces.IDisplayLayoutManager">
         </service>
      </serviceFactory>
      <serviceFactory
            factoryClass="gama.ui.experiment.factories.RuntimeExceptionHandlerFactory">
         <service
               serviceClass="gama.common.ui.IRuntimeExceptionHandler">
         </service>
      </serviceFactory>
   </extension>
   <extension
         point="org.eclipse.core.expressions.propertyTesters">
      <propertyTester
            class="gama.ui.experiment.perspective.PerspectiveNamePropertyTester"
            id="gama.tester.PerspectiveNamePropertyTester"
            namespace="gama.ui"
            properties="containsString"
            type="java.lang.Object">
      </propertyTester>
   </extension>

</plugin>
